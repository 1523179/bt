
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Algorithms &mdash; bt 0.1.2 documentation</title>
    
    <link rel="stylesheet" href="_static/css/klink.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="bt 0.1.2 documentation" href="index.html" />
    <link rel="next" title="The Tree Structure" href="tree.html" />
    <link rel="prev" title="Getting Started" href="install.html" />
         
        <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
        
            <link rel="shortcut icon" href="_static/favicon.ico">
        
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,500,700' rel='stylesheet' type='text/css'>
    
  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="algorithms">
<h1>Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>One of the core building blocks of bt is the <a class="reference internal" href="bt.html#bt.core.Algo" title="bt.core.Algo"><tt class="xref py py-class docutils literal"><span class="pre">Algo</span></tt></a> and the
closely related <a class="reference internal" href="bt.html#bt.core.AlgoStack" title="bt.core.AlgoStack"><tt class="xref py py-class docutils literal"><span class="pre">AlgoStack</span></tt></a>.</p>
<img alt="algo stack" class="align-center" src="_images/stack.png" />
<div class="section" id="algos">
<h3>Algos<a class="headerlink" href="#algos" title="Permalink to this headline">¶</a></h3>
<p>An Algo is essentially a function that returns True or False. It takes a single
argument that is the <a class="reference internal" href="bt.html#bt.core.Strategy" title="bt.core.Strategy"><tt class="xref py py-class docutils literal"><span class="pre">Strategy</span></tt></a> being tested. An Algo should ideally
only serve one specific purpose. This purpose can control execution flow, it can
control security selection, security allocation, etc. For example,
you can have an Algo that checks if the month has changed (such as
<a class="reference internal" href="bt.html#bt.algos.RunMonthly" title="bt.algos.RunMonthly"><tt class="xref py py-class docutils literal"><span class="pre">bt.algos.RunMonthly</span></tt></a>). If it has, this Algo return True, if not, False.</p>
</div>
<div class="section" id="algo-stacks">
<h3>Algo Stacks<a class="headerlink" href="#algo-stacks" title="Permalink to this headline">¶</a></h3>
<p>An <a class="reference internal" href="bt.html#bt.core.AlgoStack" title="bt.core.AlgoStack"><tt class="xref py py-class docutils literal"><span class="pre">AlgoStack</span></tt></a> is a class that groups together many
Algos and runs them one after another as long as each Algo returns True. As soon
as an Algo returns False, the AlgoStack stops its execution and returns False
(an AlgoStack is an Algo after all).  This allows us to combine different Algos
together and control the flow of execution with the Algo return value. Many
AlgoStacks can they themselves be included into another AlgoStack should the
need arise.</p>
<p>By breaking down strategy logic into these small blocks of code, we achieve
testability and reusability - two appealing features when working on software
development.</p>
</div>
</div>
<div class="section" id="data-passing">
<h2>Data Passing<a class="headerlink" href="#data-passing" title="Permalink to this headline">¶</a></h2>
<p>In order to pass data between different Algos, the Strategy has two properties:
<strong>temp</strong> and <strong>perm</strong>. They are both dictionaries and are used for storing data
generated by Algos. Temporary data is refreshed on each data change whereas
permanent data is not altered.</p>
<p>Algos usually <strong>set</strong> and/or <strong>require</strong> values in the temp or perm objects. For example,
the <a class="reference internal" href="bt.html#bt.algos.WeighEqually" title="bt.algos.WeighEqually"><tt class="xref py py-class docutils literal"><span class="pre">bt.algos.WeighEqually</span></tt></a> Algo sets the &#8216;weights&#8217; key in temp, and
it requires the &#8216;selected&#8217; key in temp.</p>
<p>For example, let&#8217;s take a simple select -&gt; weight -&gt; allocate logic chain. We
would break this strategy up into 3 Algos:</p>
<ul class="simple">
<li><strong>selection</strong>
Which securities do I want to allocate capital to out of the entire universe of
investable assets?</li>
<li><strong>weighting</strong>
How much weight should each of the selected securities have in the target
portfolio?</li>
<li><strong>allocate</strong>
Close out positions that are no longer needed and allocate capital to those
that were selected and given target weights.</li>
</ul>
<p>In this case, the selection Algo could set the &#8216;selected&#8217; key in the strategy&#8217;s
temp dict, and the weighting Algo could read those values and in turn set the
&#8216;weights&#8217; key in the temp dict. The allocation Algo would then read the
&#8216;weights&#8217; and act accordingly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To preserve maximal flexibility, there
are currently no checks to make sure the AlgoStack is valid. Therefore, it is up
to the user and creator of Algos to make sure the requirements and side effects
are well documented and properly used (by the way, this may not be a great way
to go about this problem. If you have a better idea, please let me know!).</p>
<p class="last">Developpers should add a section in the docstring that outlines
the &#8220;sets&#8221; and the &#8220;requires&#8221;. See the doctrings of
<a class="reference internal" href="bt.html#bt.algos.WeighEqually" title="bt.algos.WeighEqually"><tt class="xref py py-class docutils literal"><span class="pre">bt.algos.WeighEqually</span></tt></a> for an example.</p>
</div>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>In most cases, Algos must preserve some kind of state. In this case, it is
easier to implement them as classes and define the __call__ method, like
below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyAlgo</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">Algo</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg1</span> <span class="o">=</span> <span class="n">arg1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arg2</span> <span class="o">=</span> <span class="n">arg2</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="c"># my logic goes here</span>

        <span class="c"># accessing/storing variables through target.temp[&#39;key&#39;]</span>

        <span class="c"># remember to return a bool - True in most cases</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
<p>However, for Algos that do not need to preserve any state, you may simply
implement them as a basic function that takes one argument - the Strategy:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">MyAlgo2</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
    <span class="c"># all the logic</span>

    <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        <aside>

            
            <a href="index.html" id="logo" title=bt><img class="logo" src="_static/logo.png" width="150px" height="150px" title=bt /></a>
            
            
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html"> Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html"> Installation Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href=""> All About Algos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-passing">Data Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tree.html"> The Tree Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="bt.html"> API</a></li>
</ul>


            
            <ul>
                <li><a href="https://github.com/pmorissette/bt">Github</a></li>
            </ul>
            
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </aside>
    
      <div class="clearer"></div>
    </div>
        <div class="footer">
            bt was created by Philippe Morissette. If you find a bug, please <a href="https://github.com/pmorissette/bt/issues/new" title="Open a new issue on Github">submit an issue</a> on Github.
        </div>

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-52308448-3', 'auto');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
        
  </body>
</html>